@tailwind base;
@tailwind components;
@tailwind utilities;

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overflow-x: hidden;
  /* Prevent pull-to-refresh on mobile */
  overscroll-behavior-y: contain;
  /* Better touch scrolling */
  -webkit-overflow-scrolling: touch;
  /* PWA: Prevent text selection on long press (improves app feel) */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
  /* iOS PWA full screen support - take full height of html (which includes safe areas) */
  width: 100%;
  max-width: 100vw;
  height: 100%;
  margin: 0;
  padding: 0;
  /* Prevent content overflow */
  position: relative;
  box-sizing: border-box;
}

/* Allow text selection in input fields and content areas */
input,
textarea,
[contenteditable],
.selectable {
  -webkit-user-select: text;
  user-select: text;
}

/* Mobile-first responsive - hide on tablets/desktop */
@media (min-width: 768px) {
  body::before {
    content: 'This app is designed for mobile devices only. Please open on a mobile device.';
    display: block;
    padding: 2rem;
    text-align: center;
    background: #f3f4f6;
    color: #6b7280;
  }
}

/* Smooth scrolling */
html {
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  /* iOS PWA full screen support - take full viewport height */
  width: 100%;
  max-width: 100vw;
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height for mobile browsers */
  height: -webkit-fill-available;
  margin: 0;
  padding: 0;
  /* Prevent horizontal scroll */
  overflow-x: hidden;
  box-sizing: border-box;
}

/* Safe area variables for use in components */
:root {
  --safe-area-inset-top: env(safe-area-inset-top);
  --safe-area-inset-bottom: env(safe-area-inset-bottom);
  --safe-area-inset-left: env(safe-area-inset-left);
  --safe-area-inset-right: env(safe-area-inset-right);
  --header-height: 60px;
  /* Header height including safe area - approximate, will be adjusted per page */
  --header-total-height: calc(70px + env(safe-area-inset-top, 0px));
}

/* Hide scrollbars completely - native app feel */
::-webkit-scrollbar {
  display: none;
  width: 0;
  height: 0;
  background: transparent;
}

::-webkit-scrollbar-track {
  display: none;
  background: transparent;
}

::-webkit-scrollbar-thumb {
  display: none;
  background: transparent;
}

/* Hide scrollbars for Firefox and IE/Edge */
html, body, * {
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE and Edge */
}

/* Main app container for full screen on iOS */
#__next {
  width: 100%;
  max-width: 100vw;
  /* Take full viewport height including safe areas */
  height: 100vh;
  height: 100dvh;
  height: -webkit-fill-available;
  min-height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  /* Add safe area padding: content starts below status bar */
  /* Note: Don't add bottom padding here - NavBar handles it and pages account for NavBar height */
  padding-top: env(safe-area-inset-top, 0px);
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
  /* Ensure content doesn't overflow */
  position: relative;
  box-sizing: border-box;
}

/* iOS PWA specific: When in standalone mode, ensure full screen */
/* This only applies when app is launched from home screen, not Safari */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari - detect standalone mode */
  html.standalone {
    height: 100vh;
    height: 100dvh;
    height: -webkit-fill-available;
    width: 100%;
  }
  
  html.standalone body {
    height: 100%;
    width: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden; /* Prevent body scroll - #__next handles scrolling */
  }
  
  html.standalone #__next {
    height: 100vh;
    height: 100dvh;
    height: -webkit-fill-available;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    /* Content starts below status bar */
    /* Note: Don't add bottom padding here - NavBar handles it and pages account for NavBar height */
    padding-top: env(safe-area-inset-top, 0px);
    padding-left: env(safe-area-inset-left, 0px);
    padding-right: env(safe-area-inset-right, 0px);
  }
  
  /* Ensure NavBar sits flush at bottom in PWA mode with no gap */
  html.standalone nav[class*="fixed"][class*="bottom-0"] {
    bottom: 0 !important;
    margin-bottom: 0 !important;
    position: fixed !important;
  }
  
  /* Ensure no extra space below viewport in PWA mode */
  html.standalone {
    overflow: hidden;
  }
  
  html.standalone body {
    overflow: hidden;
  }
}

/* Touch-friendly buttons */
button, a {
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* Safe area insets for mobile */
.pb-safe {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.pt-safe {
  padding-top: env(safe-area-inset-top, 0px);
}

/* Content spacing below sticky header */
.content-below-header {
  padding-top: calc(70px + env(safe-area-inset-top, 0px));
}

/* For pages with dynamic header height (like orders page) */
.content-below-header-dynamic {
  /* Will be set inline based on measured header height */
}

.pl-safe {
  padding-left: env(safe-area-inset-left, 0px);
}

.pr-safe {
  padding-right: env(safe-area-inset-right, 0px);
}

/* Ensure all content fits within viewport */
* {
  max-width: 100%;
  box-sizing: border-box;
}

/* Prevent horizontal overflow */
img, video, iframe, embed, object {
  max-width: 100%;
  height: auto;
}

/* Responsive container that adapts to all screen sizes */
.container-responsive {
  width: 100%;
  max-width: 100vw;
  margin: 0 auto;
  padding-left: max(1rem, env(safe-area-inset-left, 0px));
  padding-right: max(1rem, env(safe-area-inset-right, 0px));
  box-sizing: border-box;
}

/* Ensure fixed elements account for safe areas */
.fixed-bottom {
  bottom: env(safe-area-inset-bottom, 0px);
}

.fixed-top {
  top: env(safe-area-inset-top, 0px);
}

/* Responsive text sizing */
@media (max-width: 375px) {
  html {
    font-size: 14px;
  }
}

@media (min-width: 376px) and (max-width: 414px) {
  html {
    font-size: 15px;
  }
}

@media (min-width: 415px) {
  html {
    font-size: 16px;
  }
}

/* Landscape orientation adjustments */
@media (orientation: landscape) and (max-height: 500px) {
  /* Reduce padding in landscape on small screens */
  #__next {
    padding-top: max(env(safe-area-inset-top, 0px), 0.5rem);
    padding-bottom: max(env(safe-area-inset-bottom, 0px), 0.5rem);
  }
}

/* Prevent table overflow */
table {
  width: 100%;
  max-width: 100%;
  table-layout: auto;
  border-collapse: collapse;
}

/* Ensure scrollable containers don't overflow viewport */
.overflow-x-auto,
.overflow-x-scroll {
  max-width: 100%;
  width: 100%;
  box-sizing: border-box;
  /* Add safe area padding for horizontal scroll */
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
}

/* Ensure inline-block elements don't overflow */
.inline-block {
  max-width: 100%;
  box-sizing: border-box;
}

/* Responsive images and media */
img, video, iframe {
  max-width: 100%;
  height: auto;
  display: block;
}

/* Safe area utilities for specific use cases */
.safe-area-x {
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
}

/* Fix for sticky headers - since html has safe area padding, top-0 is already correct */
.sticky.top-0 {
  top: 0; /* Already positioned correctly below status bar due to html padding */
}

/* Ensure modals and drawers account for safe areas */
[class*="fixed"],
[class*="absolute"] {
  max-width: 100vw;
  box-sizing: border-box;
}

/* Prevent text overflow */
p, span, div, h1, h2, h3, h4, h5, h6 {
  word-wrap: break-word;
  overflow-wrap: break-word;
  hyphens: auto;
}

/* Ensure buttons and inputs fit within viewport */
button, input, select, textarea {
  max-width: 100%;
  box-sizing: border-box;
}

/* Native app feel for order list table */
table tbody tr {
  min-height: 48px; /* Minimum touch target size */
}

table tbody td {
  vertical-align: middle;
  padding: 0.5rem 0.375rem; /* Better spacing for touch */
}

/* Larger touch targets for action buttons */
table tbody button {
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Toast animations */
@keyframes slide-in {
  from {
    transform: translateX(-50%) translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
  }
}

.animate-slide-in {
  animation: slide-in 0.3s ease-out;
}

/* SweetAlert2 Mobile Styles */
.swal2-popup-mobile {
  font-size: 16px !important;
  padding: 1.5rem !important;
  border-radius: 1rem !important;
  max-width: 90% !important;
}

/* SweetAlert2 Backdrop - Force visibility */
.swal2-backdrop-show {
  background-color: rgba(0, 0, 0, 0.4) !important;
}

.swal2-container {
  width: 100% !important;
  height: 100% !important;
  display: block !important;
  visibility: visible !important;
}

/* SweetAlert2 Mobile Button Styles */
.swal2-confirm-mobile,
.swal2-cancel-mobile {
  padding: 0.5rem 1rem !important;
  font-size: 14px !important;
  border-radius: 0.5rem !important;
  margin: 0.25rem !important;
  min-width: 100px !important;
}

/* Compact SweetAlert2 styling */
.swal2-popup-mobile {
  padding: 1rem !important;
  font-size: 0.875rem !important;
  border-radius: 0.5rem !important;
  max-width: 90% !important;
}

.swal2-title-mobile {
  font-size: 1rem !important;
  margin-bottom: 0.5rem !important;
  padding: 0 !important;
}

.swal2-html-container-mobile {
  font-size: 0.8125rem !important;
  margin: 0.5rem 0 !important;
  padding: 0 !important;
}

.swal2-confirm-mobile,
.swal2-cancel-mobile {
  padding: 0.375rem 0.75rem !important; /* compact */
  font-size: 12px !important; /* 12px */
  margin: 0.25rem !important;
  border-radius: 0.375rem !important;
}

.swal2-actions {
  margin-top: 0.75rem !important;
  gap: 0.5rem !important;
}

.swal2-icon {
  width: 3rem !important;
  height: 3rem !important;
  margin: 0.5rem auto 0.75rem !important;
}

.swal2-icon svg {
  width: 2rem !important;
  height: 2rem !important;
}

.swal2-input,
.swal2-textarea {
  font-size: 0.875rem !important;
  padding: 0.5rem !important;
  margin: 0.5rem 0 !important;
}

/* PWA: Standalone mode styles */
@media (display-mode: standalone) {
  body {
    /* Add any specific styles for standalone PWA mode */
  }
  
  /* Hide browser UI elements in standalone mode */
  .browser-only {
    display: none;
  }
}

/* PWA: Splash screen background */
@media (display-mode: standalone) {
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #0d9488 0%, #14b8a6 100%);
    z-index: 9999;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease-out;
  }
}

/* Custom checkbox styling */
.custom-checkbox {
  appearance: none;
  -webkit-appearance: none;
  width: 1.25rem;
  height: 1.25rem;
  border: 2px solid #9ca3af;
  border-radius: 0.375rem;
  background-color: white;
  cursor: pointer;
  position: relative;
  transition: all 0.2s;
}

.custom-checkbox:checked {
  background-color: #0d9488;
  border-color: #0d9488;
}

.custom-checkbox:checked::after {
  content: '';
  position: absolute;
  left: 4px;
  top: 1px;
  width: 5px;
  height: 10px;
  border: solid white;
  border-width: 0 2px 2px 0;
  border-radius: 1px;
  transform: rotate(45deg);
}

.custom-checkbox:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(14, 165, 233, 0.3);
}

/* Prevent zoom on input focus (iOS) - use 16px font size on mobile */
@media screen and (max-width: 768px) {
  input[type="text"],
  input[type="number"],
  input[type="email"],
  input[type="tel"],
  input[type="date"],
  input[type="time"],
  input[type="datetime-local"],
  select,
  textarea {
    font-size: 16px !important; /* Prevents zoom on iOS */
  }
}

/* Select dropdown styling */
select {
  appearance: none;
  -webkit-appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23374151' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 12px;
  padding-right: 2.5rem;
}

select:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(14, 165, 233, 0.3);
}

select:disabled {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23374151' d='M6 9L1 4h10z'/%3E%3C/svg%3E") !important;
  background-color: white !important;
}

/* Loading spinner */
.spinner {
  width: 1.5rem;
  height: 1.5rem;
  border: 2px solid #9ca3af;
  border-radius: 0.375rem;
  border-top-color: #0d9488;
  animation: spin 0.6s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* Scrollbar hide utility (already handled globally, but kept for compatibility) */
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Smooth expand/collapse animation */
@keyframes expand {
  from {
    max-height: 0;
    opacity: 0;
  }
  to {
    max-height: 500px;
    opacity: 1;
  }
}

@keyframes collapse {
  from {
    max-height: 500px;
    opacity: 1;
  }
  to {
    max-height: 0;
    opacity: 0;
  }
}

.animate-expand {
  animation: expand 0.3s ease-out forwards;
  overflow: hidden;
}

.animate-collapse {
  animation: collapse 0.3s ease-out forwards;
  overflow: hidden;
}

/* Native app modal animations - spring-like effect */
@keyframes modal-enter {
  from {
    transform: scale3d(0.9, 0.9, 1) translate3d(0, -20px, 0);
    opacity: 0;
  }
  to {
    transform: scale3d(1, 1, 1) translate3d(0, 0, 0);
    opacity: 1;
  }
}

@keyframes modal-exit {
  from {
    transform: scale3d(1, 1, 1) translate3d(0, 0, 0);
    opacity: 1;
  }
  to {
    transform: scale3d(0.9, 0.9, 1) translate3d(0, -20px, 0);
    opacity: 0;
  }
}

@keyframes backdrop-enter {
  from {
    opacity: 0;
  }
  to {
    opacity: 0.5;
  }
}

@keyframes backdrop-exit {
  from {
    opacity: 0.5;
  }
  to {
    opacity: 0;
  }
}

/* Native app drawer animations - smooth slide */
@keyframes drawer-enter {
  from {
    transform: translate3d(100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}

@keyframes drawer-exit {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(100%, 0, 0);
  }
}

/* Native app bottom sheet animations - spring effect */
@keyframes bottom-sheet-enter {
  from {
    transform: translate3d(0, 100%, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}

@keyframes bottom-sheet-exit {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(0, 100%, 0);
  }
}

/* Native-like easing curves */
.native-modal-enter {
  animation: modal-enter 0.35s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  will-change: transform, opacity;
}

.native-modal-exit {
  animation: modal-exit 0.25s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  will-change: transform, opacity;
}

.native-backdrop-enter {
  animation: backdrop-enter 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  will-change: opacity;
}

.native-backdrop-exit {
  animation: backdrop-exit 0.25s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  will-change: opacity;
}

.native-drawer-enter {
  animation: drawer-enter 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  will-change: transform;
}

.native-drawer-exit {
  animation: drawer-exit 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  will-change: transform;
}

.native-bottom-sheet-enter {
  animation: bottom-sheet-enter 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  will-change: transform;
}

.native-bottom-sheet-exit {
  animation: bottom-sheet-exit 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  will-change: transform;
}

/* Mobile-specific input styling */
@media screen and (max-width: 768px) {
  input[type="text"],
  input[type="number"],
  input[type="email"],
  input[type="tel"],
  input[type="date"],
  input[type="time"],
  input[type="datetime-local"],
  select,
  textarea {
    font-size: 16px !important; /* Prevents zoom on iOS */
  }
}

/* PWA: Offline indicator */
.offline-indicator {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: #ef4444;
  color: white;
  text-align: center;
  padding: 0.5rem;
  z-index: 10000;
  transform: translateY(-100%);
  transition: transform 0.3s ease-out;
}

.offline-indicator.show {
  transform: translateY(0);
}

/* PWA: App-like transitions */
@media (display-mode: standalone) {
  * {
    /* Smooth transitions for app-like feel */
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  }
}
