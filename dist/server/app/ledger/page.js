(()=>{var e={};e.id=537,e.ids=[537],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},95480:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=r(67096),n=r(16132),i=r(37284),s=r.n(i),l=r(32564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["ledger",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,60991)),"C:\\Users\\ashis\\Desktop\\royalsuppliers\\royalsuppliers\\app\\ledger\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,29184)),"C:\\Users\\ashis\\Desktop\\royalsuppliers\\royalsuppliers\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\ashis\\Desktop\\royalsuppliers\\royalsuppliers\\app\\ledger\\page.tsx"],m="/ledger/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/ledger/page",pathname:"/ledger",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},83220:(e,t,r)=>{Promise.resolve().then(r.bind(r,99711))},99711:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>LedgerPage});var a=r(30784),n=r(9885),i=r.n(n),s=r(9909),l=r(93188),o=r(14885),d=r(90391),c=r(56206),m=r(71163),u=r(517),p=r(53488),g=r(89815),x=r(52156),y=r(21094),h=r(22385),f=r(81766),b=r(2861),v=r(66908),w=r(45894),N=r(93680),j=r(39546),S=r(1264),$=r(26303),C=r(51910),T=r(4780),k=r(59233),P=r(32737),D=r(89342),E=r(28571);function BottomSheet({isOpen:e,onClose:t,onConfirm:r,title:i,message:s,children:l,confirmText:o="Confirm",cancelText:d="Cancel",confirmColor:c="red"}){let m=(0,n.useRef)(null),u=(0,n.useRef)(null),[p,g]=(0,n.useState)(!1),[x,y]=(0,n.useState)(!1);(0,n.useEffect)(()=>(e?(document.body.style.overflow="hidden",g(!1),requestAnimationFrame(()=>{y(!0)})):(y(!1),document.body.style.overflow=""),()=>{document.body.style.overflow=""}),[e]);let handleClose=()=>{g(!0),y(!1),setTimeout(()=>{t(),g(!1)},350)};return e?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{ref:u,onClick:e=>{e.target===u.current&&handleClose()},className:`fixed inset-0 bg-black z-[99990] ${p?"native-backdrop-exit":x?"native-backdrop-enter":"opacity-0"}`,style:{WebkitTapHighlightColor:"transparent"}}),(0,a.jsxs)("div",{ref:m,className:`fixed bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl z-[100000] ${p?"native-bottom-sheet-exit":x?"native-bottom-sheet-enter":"translate-y-full"}`,style:{WebkitOverflowScrolling:"touch",touchAction:"pan-y",paddingBottom:"env(safe-area-inset-bottom, 0)",backfaceVisibility:"hidden",willChange:"transform"},onClick:e=>e.stopPropagation(),children:[a.jsx("div",{className:"flex justify-center pt-3 pb-2",children:a.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full"})}),(0,a.jsxs)("div",{className:"px-4 pb-4",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:i}),s&&a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:s}),l&&a.jsx("div",{className:"mb-6",children:l}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("button",{onClick:()=>{r(),handleClose()},className:`w-full py-3 ${{red:"bg-red-600 active:bg-red-700",blue:"bg-blue-600 active:bg-blue-700",green:"bg-green-600 active:bg-green-700",amber:"bg-amber-600 active:bg-amber-700"}[c]} text-white rounded-lg font-semibold transition-colors touch-manipulation`,style:{WebkitTapHighlightColor:"transparent",fontSize:"16px"},children:o}),a.jsx("button",{onClick:handleClose,className:"w-full py-3 bg-gray-100 text-gray-700 rounded-lg font-semibold active:bg-gray-200 transition-colors touch-manipulation",style:{WebkitTapHighlightColor:"transparent",fontSize:"16px"},children:d})]})]})]})]}):null}let formatLocalDate=e=>{let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`},parseToLocalDateString=e=>{if(!e)return formatLocalDate(new Date);if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;try{let t=new Date(e);if(isNaN(t.getTime()))return console.warn("Invalid date string:",e),formatLocalDate(new Date);return formatLocalDate(t)}catch(t){return console.warn("Error parsing date:",e,t),formatLocalDate(new Date)}},getStepOrder=e=>{let t=["amount","date"];return"debit"===e?[...t,"supplier","note"]:[...t,"partyName","note"]};function LedgerEntryWizard({entry:e,type:t,onClose:r,onSave:i,onDelete:s,onDeleteConfirm:o}){let d=getStepOrder(t),m=!!e?.id,[p,g]=(0,n.useState)(0),[x,y]=(0,n.useState)(!1),[h,b]=(0,n.useState)(!1),[I,A]=(0,n.useState)({amount:e?.amount||0,date:e?.date?parseToLocalDateString(e.date):formatLocalDate(new Date),note:e?.note||"",supplier:e?.supplier||"",partyName:e?.partyName||""});(0,n.useEffect)(()=>{e&&A({amount:e.amount||0,date:e.date?parseToLocalDateString(e.date):formatLocalDate(new Date),note:e.note||"",supplier:e.supplier||"",partyName:e.partyName||""})},[e?.id,e?.date,e?.amount,e?.note,e?.supplier,e?.partyName]);let[M,z]=(0,n.useState)([]),[Z,O]=(0,n.useState)([]),L=(0,n.useRef)(null),loadOptions=async()=>{try{let[e,t]=await Promise.all([k.XK.getUniqueSuppliers(),k.XK.getUniquePartyNames()]);z(e),O(t)}catch(e){console.error("Error loading options:",e)}},H=(0,n.useCallback)(()=>{x||r()},[x,r]);(0,n.useEffect)(()=>{loadOptions()},[]),(0,n.useEffect)(()=>{let handleEscape=e=>{"Escape"!==e.key||x||H()};return window.addEventListener("keydown",handleEscape),()=>{window.removeEventListener("keydown",handleEscape)}},[x,H]);let handlePrevious=()=>{p>0&&g(p-1)},handleAfterEdit=()=>{let e=d[p];"amount"===e&&I.amount>0?setTimeout(()=>{p<d.length-1&&g(p+1)},300):"date"===e&&I.date&&setTimeout(()=>{p<d.length-1&&g(p+1)},300)},canSave=()=>{let e="credit"!==t||!!I.partyName.trim();return I.amount>0&&!!I.date&&e},handleStepClick=e=>{e!==p&&g(e)},getStepIcon=e=>{let t={amount:v.Z,date:u.Z,supplier:w.Z,partyName:N.Z,note:j.Z,review:S.Z};return t[e]},isStepComplete=e=>{switch(e){case"amount":return I.amount>0;case"date":return!!I.date;case"supplier":return"debit"!==t||!!I.supplier.trim();case"partyName":return"credit"!==t||!!I.partyName.trim();case"note":case"review":return!0;default:return!1}},getStepValue=e=>{switch(e){case"amount":return I.amount>0?(0,f.formatIndianCurrency)(I.amount):"Not set";case"date":if(!I.date)return"Not set";try{let e=I.date.includes("T")?I.date:I.date+"T12:00:00",t=new Date(e);if(isNaN(t.getTime()))return"Not set";return(0,l.ZP)(t,"dd MMM yyyy")}catch(e){return console.error("Error formatting date:",e),"Not set"}case"supplier":return I.supplier||"";case"partyName":return I.partyName||"";case"note":return I.note||"";default:return""}},handleSubmit=async()=>{if(I.amount<=0){alert("Please enter a valid amount");return}if("credit"===t&&!I.partyName.trim()){alert("Please select a party name");return}y(!0);try{await i({amount:I.amount,date:I.date,note:(I.note||"").trim()||void 0,supplier:"debit"===t&&(I.supplier||"").trim()||void 0,partyName:"credit"===t&&(I.partyName||"").trim()||void 0}),H()}catch(e){console.error("Error saving entry:",e),alert(e?.message||"Error saving entry. Please try again."),y(!1)}},W=Math.max(0,Math.min(p,d.length-1)),q=d[W];q&&getStepIcon(q);let _=d.filter(e=>"review"!==e),F=_.filter(e=>{let t=getStepValue(e);return t&&"Not set"!==t&&"‚Çπ0"!==t&&""!==t});return(0,n.useEffect)(()=>{(p<0||p>=d.length)&&g(0)},[p,d.length]),(0,a.jsxs)("div",{className:"bg-gray-50 min-h-screen flex flex-col",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:[(0,a.jsxs)("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2.5",children:[a.jsx("button",{onClick:H,className:"p-1.5 active:bg-gray-100 active:scale-95 rounded-lg transition-all duration-150",style:{WebkitTapHighlightColor:"transparent"},children:a.jsx(c.Z,{size:18,className:"text-gray-600"})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-base font-bold text-gray-900",children:m?`Edit ${"credit"===t?"Income":"Expense"}`:`New ${"credit"===t?"Income":"Expense"}`}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[F.length," / ",_.length," completed"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[m&&e?.id&&(0,a.jsxs)("button",{onClick:()=>{e?.id&&b(!0)},disabled:x,className:"px-3 py-1.5 bg-red-50 border border-red-200 text-red-600 text-xs font-semibold rounded-lg active:bg-red-100 active:border-red-300 transition-all disabled:opacity-50 flex items-center gap-1.5",style:{WebkitTapHighlightColor:"transparent"},children:[a.jsx($.Z,{size:14}),"Delete"]}),canSave()&&"note"===q&&(0,a.jsxs)("button",{onClick:handleSubmit,disabled:x,className:"px-3 py-1.5 bg-green-600 text-white text-xs font-semibold rounded-lg active:bg-green-700 transition-all disabled:opacity-50 flex items-center gap-1.5",style:{WebkitTapHighlightColor:"transparent"},children:[a.jsx(S.Z,{size:14}),"Save"]})]})]}),F.length>0&&a.jsx("div",{className:"px-3 pb-2 border-b border-gray-100 bg-gradient-to-br from-gray-50 to-gray-100/50",children:a.jsx("div",{className:"flex flex-wrap gap-1",children:_.map((e,t)=>{let r=getStepValue(e);if("Not set"===r||"‚Çπ0"===r||""===r)return null;let n=t===W,i=getStepIcon(e);return i?(0,a.jsxs)("button",{onClick:()=>handleStepClick(t),className:`px-1.5 py-0.5 bg-white border rounded text-xs text-left active:bg-gray-50 active:scale-95 transition-all duration-150 flex items-center gap-1 ${n?"border-primary-400 bg-primary-50":"border-gray-200"}`,style:{WebkitTapHighlightColor:"transparent"},children:[a.jsx(i,{size:9,className:`flex-shrink-0 ${n?"text-primary-600":"text-gray-400"}`}),a.jsx("span",{className:`truncate max-w-[60px] ${n?"text-primary-700":"text-gray-600"}`,children:r})]},e):null})})}),a.jsx("div",{className:"px-3 py-1.5 bg-gray-50 border-b border-gray-100",children:a.jsx("div",{className:"flex gap-0.5",children:d.map((e,t)=>{let r=isStepComplete(e);return a.jsx("div",{className:`flex-1 h-0.5 rounded-full transition-all duration-200 ${r?"bg-green-500":t===W?"bg-primary-600":"bg-gray-300"}`},e)})})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",style:{WebkitOverflowScrolling:"touch",paddingBottom:"5rem"},children:a.jsx("div",{className:"max-w-2xl mx-auto w-full px-3 py-3"})}),a.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 shadow-lg z-20",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto w-full px-3 py-3",children:[a.jsx("div",{className:"mb-3",children:(()=>{let e=Math.max(0,Math.min(p,d.length-1)),r=d[e];if(!r)return null;switch(r){case"amount":return a.jsx(P.Z,{value:I.amount,onChange:e=>{L.current=e,A({...I,amount:e})},onClose:()=>{L.current=null},label:`Enter ${"credit"===t?"Income":"Expense"} Amount`,inline:!0,hideDoneButton:!0,showCurrency:!0});case"date":return a.jsx("div",{className:"w-full",children:m?(0,a.jsxs)("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg text-center",children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Date cannot be changed for existing entries"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(0,l.ZP)(new Date(I.date),"dd MMM yyyy")})]}):a.jsx(E.Z,{value:I.date,onChange:e=>{A({...I,date:e}),setTimeout(()=>handleAfterEdit(),100)},onClose:()=>{},label:"Select Date",inline:!0})});case"supplier":return a.jsx(D.Z,{options:M,value:I.supplier,onChange:e=>{A({...I,supplier:e}),setTimeout(()=>handleAfterEdit(),100)},onClose:()=>{},label:"Select Supplier",allowCustom:!0,onCustomAdd:e=>{z([...M,e])},inline:!0,autoFocusSearch:!1});case"partyName":return a.jsx(D.Z,{options:Z,value:I.partyName,onChange:e=>{A({...I,partyName:e}),setTimeout(()=>handleAfterEdit(),100)},onClose:()=>{},label:"Select Party Name",allowCustom:!0,onCustomAdd:e=>{O([...Z,e])},inline:!0,autoFocusSearch:!1});case"note":return(0,a.jsxs)("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note (Optional)"}),a.jsx("textarea",{value:I.note,onChange:e=>{A({...I,note:e.target.value})},placeholder:"Add a note (optional)",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",rows:4,style:{WebkitTapHighlightColor:"transparent",fontFamily:"inherit"}})]});default:return null}})()}),"note"===q?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{onClick:handleSubmit,disabled:x||!canSave(),className:"w-full h-11 bg-green-600 text-white rounded-lg font-semibold active:bg-green-700 transition-all duration-100 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 active:scale-[0.98] shadow-md text-sm",style:{WebkitTapHighlightColor:"transparent"},children:[x?"Saving...":m?"Save Changes":"Save Entry",!x&&a.jsx(S.Z,{size:16})]}),a.jsx("div",{className:"flex gap-2",children:p>0&&(0,a.jsxs)("button",{onClick:handlePrevious,className:"flex-1 h-10 bg-gray-100 text-gray-700 rounded-lg font-medium active:bg-gray-200 transition-all duration-100 flex items-center justify-center gap-1.5 active:scale-[0.98] text-sm",style:{WebkitTapHighlightColor:"transparent"},children:[a.jsx(C.Z,{size:14}),"Back"]})})]}):(0,a.jsxs)("div",{className:"flex gap-2",children:[p>0&&(0,a.jsxs)("button",{onClick:handlePrevious,className:"flex-1 h-10 bg-gray-100 text-gray-700 rounded-lg font-medium active:bg-gray-200 transition-all duration-100 flex items-center justify-center gap-1.5 active:scale-[0.98] text-sm",style:{WebkitTapHighlightColor:"transparent"},children:[a.jsx(C.Z,{size:16}),"Back"]}),(0,a.jsxs)("button",{onClick:()=>{p<d.length-1&&g(p+1)},disabled:!(()=>{let e=Math.max(0,Math.min(p,d.length-1)),t=d[e];return!!t&&isStepComplete(t)})(),className:"flex-1 h-10 bg-primary-600 text-white rounded-lg font-medium active:bg-primary-700 transition-all duration-100 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1.5 active:scale-[0.98] text-sm shadow-md",style:{WebkitTapHighlightColor:"transparent"},children:["Continue",a.jsx(T.Z,{size:16})]})]})]})}),m&&e?.id&&a.jsx(BottomSheet,{isOpen:h,onClose:()=>b(!1),onConfirm:async()=>{e?.id&&(o?await o(e.id):s&&s(e.id),b(!1))},title:"Delete Entry?",message:"This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmColor:"red"})]})}var I=r(2389),A=r(58683),M=r(60755),z=r(29904),Z=r(3149),O=r(83643),L=r(90706),H=r(56365),W=r(12437),q=r(51443);let ensureDate=e=>{if(!e||"string"!=typeof e)return null;let t=e.includes("T")?e:`${e}T00:00:00.000Z`,r=new Date(t);return isNaN(r.getTime())?null:r},getTimelineTime=e=>{let t=ensureDate(e.createdAt||e.date);return t?t.getTime():0},getTimelineDateKey=e=>{let t=ensureDate(e.createdAt||e.date)||new Date;return(0,l.ZP)(t,"yyyy-MM-dd")};function LedgerTimelineView({entries:e,investment:t,investmentHistory:r=[],invoices:s=[],orders:o=[]}){let d=(0,n.useMemo)(()=>{let a=[...e];if(r&&r.length>0){let e=[...r].sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime());e.forEach(e=>{let t=0,r=e.note||"";if("created"===e.activityType)t=e.amount,r=r||"Initial Capital Investment";else{if("updated"!==e.activityType)return;let a=e.previousAmount||0;if((t=e.amount-a)>0)r=r||"Capital Added";else{if(!(t<0))return;r=r||"Capital Reduced"}}if(0===t)return;let n=e.date;n.includes("T")||(n+="T00:00:00.000Z"),a.push({id:`inv-act-${e.id||Math.random()}`,type:t>=0?"credit":"debit",amount:Math.abs(t),date:n,createdAt:e.timestamp||n,note:r,source:"manual",partyName:"Investment Capital"})})}else if(t){let e=t.date;e.includes("T")||(e+="T00:00:00.000Z"),a.push({id:"investment-capital",type:"credit",amount:t.amount,date:e,createdAt:t.updatedAt||e,note:t.note||"Initial Capital Investment",source:"manual",partyName:"Investment Capital"})}s.forEach(e=>{e.partialPayments&&e.partialPayments.forEach(t=>{let r=t.createdAt||t.date;a.push({id:`inv-pay-${t.id}`,type:"credit",amount:t.amount,date:t.date,createdAt:r,note:`Invoice: ${e.invoiceNumber}${t.note?` - ${t.note}`:""}`,source:"manual",partyName:e.partyName||"Unknown Party"})})}),o.forEach(e=>{e.customerPayments&&e.customerPayments.forEach(t=>{if(!t.ledgerEntryId){let r=t.createdAt||t.date;a.push({id:`ord-cust-pay-${t.id}`,type:"credit",amount:t.amount,date:t.date,createdAt:r,note:`Order Payment${t.note?` - ${t.note}`:""}`,source:"manual",partyName:e.partyName||"Unknown Party"})}}),e.partialPayments&&e.partialPayments.forEach(t=>{if(!t.ledgerEntryId){let r=t.createdAt||t.date;a.push({id:`ord-part-pay-${t.id}`,type:"debit",amount:t.amount,date:t.date,createdAt:r,note:`Order Expense${t.note?` - ${t.note}`:""}`,source:"manual",supplier:e.supplier||"Unknown Supplier"})}})}),a.sort((e,t)=>{let r=getTimelineTime(e),a=getTimelineTime(t);return r-a});let n={},i=0;a.map(e=>{let t="credit"===e.type?e.amount:-e.amount;i+=t;let r=getTimelineDateKey(e);return n[r]||(n[r]=[]),n[r].push(e),{...e,balanceAfter:i}});let l=Object.keys(n).sort().reverse(),d=i;return l.map(e=>{let t=n[e];t.sort((e,t)=>{if("Investment Capital"===e.partyName)return 1;if("Investment Capital"===t.partyName)return -1;let r=getTimelineTime(e),a=getTimelineTime(t);return a-r});let r=t.filter(e=>"credit"===e.type).reduce((e,t)=>e+t.amount,0),a=t.filter(e=>"debit"===e.type).reduce((e,t)=>e+t.amount,0),i=d,s=d-(r-a);return d=s,{date:e,entries:t,openingBalance:s,closingBalance:i,totalIncome:r,totalExpense:a}})},[e,t,r,s,o]),renderTransactionRow=e=>{let t="credit"===e.type,r=(0,f.formatIndianCurrency)(e.amount),n=t?e.partyName:e.supplier,s=e.note,l="Investment Capital"===e.partyName,o="",d=s||"",c="",u="",p=null;return l?(o="Investment Capital",d=s||(t?"Capital Added":"Capital Reduced"),c="bg-amber-100 text-amber-600",u=t?"text-green-700":"text-red-700",p=a.jsx(m.Z,{size:18})):t?(o=n||"Income",c="bg-green-100 text-green-600",u="text-green-700",p=a.jsx(W.Z,{size:18})):(o=n||"Expense",c="bg-red-100 text-red-600",u="text-red-700",p=a.jsx(q.Z,{size:18})),(0,a.jsxs)("div",{className:"px-3 py-2 flex items-center gap-2 border-b border-gray-50 last:border-0 active:bg-gray-50 transition-colors",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${c} bg-opacity-20`,children:i().cloneElement(p,{size:14})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex justify-between items-baseline",children:[a.jsx("div",{className:"text-xs font-bold text-gray-900 truncate",children:o}),(0,a.jsxs)("div",{className:`text-xs font-bold whitespace-nowrap ${u}`,children:[t?"+":"-",r]})]}),d&&a.jsx("div",{className:"text-[10px] text-gray-500 truncate leading-tight",children:d})]})]},e.id)};return 0===d.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-400",children:[a.jsx(m.Z,{size:48,className:"mb-3 opacity-20"}),a.jsx("p",{children:"No transactions found"})]}):a.jsx("div",{className:"pb-24 bg-gray-50 min-h-full",children:d.map(e=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"sticky top-0 z-10 bg-gray-50/95 backdrop-blur px-4 py-1.5 flex justify-between items-baseline border-b border-gray-100/50 shadow-sm",children:[a.jsx("h3",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider",children:(0,l.ZP)(new Date(e.date),"EEE, dd MMM")}),a.jsx("span",{className:`text-xs font-bold ${e.closingBalance>=0?"text-gray-900":"text-red-600"}`,children:(0,f.formatIndianCurrency)(e.closingBalance)})]}),(0,a.jsxs)("div",{className:"mx-3 mt-2 bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-3 py-1.5 bg-gray-50/50 border-b border-gray-100 flex justify-between items-center",children:[a.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider font-medium",children:"Closing"}),a.jsx("span",{className:`text-xs font-bold font-mono ${e.closingBalance>=0?"text-gray-900":"text-red-600"}`,children:(0,f.formatIndianCurrency)(e.closingBalance)})]}),a.jsx("div",{className:"divide-y divide-gray-50",children:e.entries.map(renderTransactionRow)}),(0,a.jsxs)("div",{className:"px-3 py-1.5 bg-gray-50/50 border-t border-gray-100 flex justify-between items-center",children:[a.jsx("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider font-medium",children:"Opening"}),a.jsx("span",{className:"text-xs text-gray-600 font-semibold font-mono",children:(0,f.formatIndianCurrency)(e.openingBalance)})]})]})]},e.date))})}var _=r(39431);function LedgerPage(){let[e,t]=(0,n.useState)([]),[r,i]=(0,n.useState)([]),[v,w]=(0,n.useState)([]),[N,j]=(0,n.useState)(!0),[S,$]=(0,n.useState)("entries"),[C,T]=(0,n.useState)([]),[P,D]=(0,n.useState)(!0),[E,W]=(0,n.useState)(!1),[q,F]=(0,n.useState)(""),[U,R]=(0,n.useState)(""),[B,K]=(0,n.useState)(!1),[X,G]=(0,n.useState)("credit"),[J,V]=(0,n.useState)("add"),[Y,Q]=(0,n.useState)(null),[ee,et]=(0,n.useState)(!1),[er,ea]=(0,n.useState)(null),[en,ei]=(0,n.useState)(null),[es,el]=(0,n.useState)([]),[eo,ed]=(0,n.useState)(!1),[ec,em]=(0,n.useState)(""),[eu,ep]=(0,n.useState)(""),[eg,ex]=(0,n.useState)(""),[ey,eh]=(0,n.useState)("add"),ef=(0,n.useMemo)(()=>{let t=e.reduce((e,t)=>e+("credit"===t.type?t.amount:-t.amount),0);return(en?.amount||0)+t},[e,en]),eb=(0,n.useMemo)(()=>e.filter(e=>"credit"===e.type).sort((e,t)=>{let r=e.createdAt?new Date(e.createdAt).getTime():e.date?new Date(e.date).getTime():0,a=t.createdAt?new Date(t.createdAt).getTime():t.date?new Date(t.date).getTime():0;return a-r}),[e]),ev=(0,n.useMemo)(()=>e.filter(e=>"debit"===e.type).sort((e,t)=>{let r=e.createdAt?new Date(e.createdAt).getTime():e.date?new Date(e.date).getTime():0,a=t.createdAt?new Date(t.createdAt).getTime():t.date?new Date(t.date).getTime():0;return a-r}),[e]),ew=(0,n.useMemo)(()=>eb.reduce((e,t)=>e+t.amount,0),[eb]),eN=(0,n.useMemo)(()=>ev.reduce((e,t)=>e+t.amount,0),[ev]),load=async()=>{j(!0);try{let[e,r,a]=await Promise.all([s.ledgerService.list(),_.z.getAllInvoices(),k.XK.getAllOrders()]);t(e),i(r),w(a)}catch(e){console.error("Failed to load ledger data:",e),t([])}finally{j(!1)}},loadInvestment=async()=>{try{let e=await H.K.getInvestment();ei(e);let t=await H.K.getActivityLog();el(t)}catch(e){console.error("Error loading investment:",e)}},openInvestmentDrawer=()=>{eh("add"),em(""),ep(new Date().toISOString().split("T")[0]),ex(""),ed(!0)},handleModeChange=e=>{eh(e),"set"===e&&en?em(en.amount.toString()):em("")};(0,n.useEffect)(()=>{load(),loadInvestment();let e=s.ledgerService.subscribe(e=>{t(e)});return()=>e()},[]),(0,n.useEffect)(()=>{if("activity"===S){D(!0);let loadActivities=async()=>{try{let e=await L.u.getActivities(q||void 0,U||void 0);T(e)}catch(e){console.error("Failed to load activities:",e),T([])}finally{D(!1)}};loadActivities();let e=L.u.subscribe(e=>{T(e),D(!1)},q||void 0,U||void 0);return()=>e()}},[S,q,U]);let handleSaveInvestment=async()=>{let e=new Date().toISOString().split("T")[0];if(!ec){(0,O.showToast)("Please fill in amount","error");return}try{let t=parseFloat(ec),r=en?.amount||0,a="add"===ey?r+t:"reduce"===ey?Math.max(0,r-t):t;await H.K.setInvestment(a,e,eg),(0,O.showToast)("Investment updated successfully","success"),ed(!1),loadInvestment()}catch(e){console.error("Error saving investment:",e),(0,O.showToast)("Failed to save investment","error")}},handleEntryClick=e=>{handleEditEntry(e)},handleAddEntry=e=>{G(e),V("add"),Q(null),K(!0)},handleEditEntry=e=>{Q(e),G(e.type),V("edit"),K(!0)},handleSaveEntry=async e=>{if("edit"===J&&Y?.id){let t=Y.partyName,r=Y.supplier,a=e.partyName?.trim()||void 0,n=e.supplier?.trim()||void 0;if(await s.ledgerService.update(Y.id,{amount:e.amount,date:e.date,note:e.note,supplier:n,partyName:a}),"credit"===Y.type){if(t&&!a)await revertIncomeDistribution(Y.id,t),await deleteLinkedPartyPayment(Y.id);else if(t&&a&&t!==a)await revertIncomeDistribution(Y.id,t),await distributeIncomeToOrders(Y.id,e.amount,a,e.date),await updateLinkedPartyPaymentPartyName(Y.id,a),await updateLinkedPartyPayment(Y.id,e.amount,e.date,e.note);else if(!t&&a)await distributeIncomeToOrders(Y.id,e.amount,a,e.date),await createPartyPaymentFromIncome(Y.id,a,e.amount,e.date,e.note);else if(t&&a&&t===a){let r=Y.amount,n=Y.date;(r!==e.amount||n!==e.date)&&(await revertIncomeDistribution(Y.id,t),await distributeIncomeToOrders(Y.id,e.amount,a,e.date),await updateLinkedPartyPayment(Y.id,e.amount,e.date,e.note))}}if("debit"===Y.type){if(r&&!n)await revertExpenseDistribution(Y.id,r);else if(r&&n&&r!==n)await revertExpenseDistribution(Y.id,r),await distributeExpenseToOrders(Y.id,e.amount,n,e.date);else if(!r&&n)await distributeExpenseToOrders(Y.id,e.amount,n,e.date);else if(r&&n&&r===n){let t=Y.amount,a=Y.date;(t!==e.amount||a!==e.date)&&(await revertExpenseDistribution(Y.id,r),await distributeExpenseToOrders(Y.id,e.amount,n,e.date))}}}else{let t=await s.ledgerService.addEntry(X,e.amount,e.note,"manual",e.date,e.supplier,e.partyName);"debit"===X&&e.supplier&&e.supplier.trim()&&await distributeExpenseToOrders(t,e.amount,e.supplier.trim(),e.date),"credit"===X&&e.partyName&&e.partyName.trim()&&(await distributeIncomeToOrders(t,e.amount,e.partyName.trim(),e.date),await createPartyPaymentFromIncome(t,e.partyName.trim(),e.amount,e.date,e.note))}},distributeExpenseToOrders=async(e,t,r,a)=>{try{console.log(`üîÑ Distributing expense ${t} for supplier ${r} (ledger entry ${e})`);let n=await k.XK.getAllOrders({supplier:r});if(0===n.length){console.warn(`No orders found for supplier ${r}`);return}console.log(`üì¶ Found ${n.length} orders for supplier ${r}`);let i=n.map(t=>{let r=t.partialPayments||[],a=r.filter(t=>t.ledgerEntryId!==e),n=a.reduce((e,t)=>e+Number(t.amount||0),0),i=Number(t.originalTotal||0),s=Math.max(0,i-n),l={...t,partialPayments:a},o=(0,k.sA)(l),d=i-n,c=i-250;return console.log(`  Order ${t.id} (${t.siteName||"N/A"}): originalTotal=${i}, totalPaid=${n}, remaining=${s}, difference=${d}, isPaid=${o}, tolerance=${c} (paid if >= ${c})`),{order:t,remaining:s,currentPayments:r,tempOrder:l,isPaid:o,difference:d,totalPaid:n,originalTotal:i}}).filter(({remaining:e,isPaid:t,order:r,totalPaid:a,originalTotal:n})=>{let i=e>0&&!t;return i?console.log(`  ‚úÖ Including order ${r.id} (${r.siteName||"N/A"}): remaining=${e}, originalTotal=${n}, totalPaid=${a}`):e<=0?console.log(`  ‚è≠Ô∏è  Skipping order ${r.id} (${r.siteName||"N/A"}): remaining=${e} <= 0 (originalTotal=${n}, totalPaid=${a})`):t&&console.log(`  ‚è≠Ô∏è  Skipping order ${r.id} (${r.siteName||"N/A"}): marked as PAID (remaining=${e}, originalTotal=${n}, totalPaid=${a}, difference=${n-a})`),i}).sort((e,t)=>{let r=new Date(e.order.date).getTime(),a=new Date(t.order.date).getTime();if(r!==a)return r-a;let n=safeGetTime(e.order.createdAt||e.order.updatedAt||e.order.date),i=safeGetTime(t.order.createdAt||t.order.updatedAt||t.order.date);return n-i});if(console.log(`‚úÖ Found ${i.length} orders with outstanding payments`),0===i.length){console.warn(`No orders with outstanding payments for supplier ${r}`),Z.nativePopup.warning("No Unpaid Orders",`No unpaid orders found for supplier "${r}". All orders are already paid or have no outstanding amount.`);return}let s=i.reduce((e,{remaining:t})=>e+t,0);console.log(`üí∞ Total outstanding across ${i.length} unpaid orders: ${s}`),t>s&&console.warn(`‚ö†Ô∏è Expense amount (${t}) exceeds total outstanding (${s})`);let l=t,o=[];for(let{order:t,remaining:r,currentPayments:n}of i){if(l<=0)break;if(!t.id){console.warn(`  ‚ö†Ô∏è Order missing ID, skipping`);continue}let i=Math.min(l,r),s=a;s&&!s.includes("T")&&(s=new Date(s+"T00:00:00").toISOString());let d={id:Date.now().toString()+Math.random().toString(36).substr(2,9),amount:i,date:s,note:"From ledger entry",ledgerEntryId:e},c=n.filter(t=>t.ledgerEntryId!==e),m=[...c,d];o.push({orderId:t.id,payment:m}),l-=i,console.log(`  ‚úì Adding payment of ${i} to order ${t.id} (order remaining: ${r-i}, expense remaining: ${l})`)}for(let{orderId:e,payment:t}of(console.log(`üìä Distribution summary: ${o.length} orders will be updated, ${l} remaining undistributed`),o))await k.XK.updateOrder(e,{partialPayments:t}),console.log(`  ‚úÖ Updated order ${e} with new payment distribution`);l>0?(console.warn(`‚ö†Ô∏è Could not fully distribute expense of ${t}. Remaining undistributed: ${l}`),Z.nativePopup.warning("Partial Distribution",`‚Çπ${t.toLocaleString("en-IN")} was entered for supplier "${r}", but only ‚Çπ${(t-l).toLocaleString("en-IN")} could be distributed to unpaid orders. ‚Çπ${l.toLocaleString("en-IN")} remains undistributed because all orders are already paid or there aren't enough unpaid orders.`)):console.log(`‚úÖ Successfully distributed expense ${t} across orders`)}catch(e){console.error("‚ùå Error distributing expense to orders:",e)}},distributeIncomeToOrders=async(e,t,r,a)=>{try{console.log(`üîÑ Distributing income ${t} for party ${r} (ledger entry ${e})`);let n=await k.XK.getAllOrders({partyName:r});if(0===n.length){console.warn(`No orders found for party ${r}`);return}console.log(`üì¶ Found ${n.length} orders for party ${r}`);let i=n.map(t=>{let r=t.customerPayments||[],a=r.filter(t=>t.ledgerEntryId!==e),n=a.reduce((e,t)=>e+Number(t.amount||0),0),i=Number(t.total||0),s=Math.max(0,i-n),l={...t,customerPayments:a},o=(0,k.jX)(l),d=i-n,c=i-250;return console.log(`  Order ${t.id} (${t.siteName||"N/A"}): sellingTotal=${i}, totalPaid=${n}, remaining=${s}, difference=${d}, isPaid=${o}, tolerance=${c} (paid if >= ${c})`),{order:t,remaining:s,currentPayments:r,tempOrder:l,isPaid:o,difference:d,totalPaid:n,sellingTotal:i}}).filter(({remaining:e,isPaid:t,order:r,totalPaid:a,sellingTotal:n})=>{let i=e>0&&!t;return i?console.log(`  ‚úÖ Including order ${r.id} (${r.siteName||"N/A"}): remaining=${e}, sellingTotal=${n}, totalPaid=${a}`):e<=0?console.log(`  ‚è≠Ô∏è  Skipping order ${r.id} (${r.siteName||"N/A"}): remaining=${e} <= 0 (sellingTotal=${n}, totalPaid=${a})`):t&&console.log(`  ‚è≠Ô∏è  Skipping order ${r.id} (${r.siteName||"N/A"}): marked as PAID (remaining=${e}, sellingTotal=${n}, totalPaid=${a}, difference=${n-a})`),i}).sort((e,t)=>{let r=new Date(e.order.date).getTime(),a=new Date(t.order.date).getTime();if(r!==a)return r-a;let n=safeGetTime(e.order.createdAt||e.order.updatedAt||e.order.date),i=safeGetTime(t.order.createdAt||t.order.updatedAt||t.order.date);return n-i});if(console.log(`‚úÖ Found ${i.length} orders with outstanding customer payments`),0===i.length){console.warn(`No orders with outstanding customer payments for party ${r}`),Z.nativePopup.warning("No Unpaid Orders",`No unpaid orders found for party "${r}". All orders are already paid or have no outstanding amount.`);return}let s=i.reduce((e,{remaining:t})=>e+t,0);console.log(`üí∞ Total outstanding across ${i.length} unpaid orders: ${s}`),t>s&&console.warn(`‚ö†Ô∏è Income amount (${t}) exceeds total outstanding (${s})`);let l=t,o=[];for(let{order:t,remaining:r,currentPayments:n}of i){if(l<=0)break;if(!t.id){console.warn(`  ‚ö†Ô∏è Order missing ID, skipping`);continue}let i=Math.min(l,r),s=a;s&&!s.includes("T")&&(s=new Date(s+"T00:00:00").toISOString());let d={id:Date.now().toString()+Math.random().toString(36).substr(2,9),amount:i,date:s,note:"From ledger entry",ledgerEntryId:e},c=n.filter(t=>t.ledgerEntryId!==e),m=[...c,d];o.push({orderId:t.id,payment:m}),l-=i,console.log(`  ‚úì Adding customer payment of ${i} to order ${t.id} (order remaining: ${r-i}, income remaining: ${l})`)}for(let{orderId:e,payment:t}of(console.log(`üìä Distribution summary: ${o.length} orders will be updated, ${l} remaining undistributed`),o))await k.XK.updateOrder(e,{customerPayments:t}),console.log(`  ‚úÖ Updated order ${e} with new customer payment distribution`);l>0?(console.warn(`‚ö†Ô∏è Could not fully distribute income of ${t}. Remaining undistributed: ${l}`),Z.nativePopup.warning("Partial Distribution",`‚Çπ${t.toLocaleString("en-IN")} was entered for party "${r}", but only ‚Çπ${(t-l).toLocaleString("en-IN")} could be distributed to unpaid orders. ‚Çπ${l.toLocaleString("en-IN")} remains undistributed because all orders are already paid or there aren't enough unpaid orders.`)):console.log(`‚úÖ Successfully distributed income ${t} across orders`)}catch(e){console.error("‚ùå Error distributing income to orders:",e)}},safeGetTime=e=>{if(!e)return 0;let t=new Date(e);return isNaN(t.getTime())?0:t.getTime()},createPartyPaymentFromIncome=async(e,t,r,a,n)=>{try{let i=(0,M.z)();if(!i)throw Error("Firebase is not configured.");let s=a;s&&!s.includes("T")&&(s=new Date(s+"T00:00:00").toISOString());let l=new Date().toISOString(),o={partyName:t,amount:r,date:s,ledgerEntryId:e,createdAt:l,updatedAt:l};n&&n.trim()&&(o.note=n.trim()),await (0,z.ET)((0,z.hJ)(i,"partyPayments"),o),console.log(`‚úÖ Party payment created for ${t}: ${r} (linked to ledger entry ${e})`)}catch(e){console.error("Error creating party payment from income entry:",e)}},updateLinkedPartyPayment=async(e,t,r,a)=>{try{let n=(0,M.z)();if(!n)throw Error("Firebase is not configured.");let i=(0,z.IO)((0,z.hJ)(n,"partyPayments"),(0,z.ar)("ledgerEntryId","==",e)),s=await (0,z.PL)(i);if(s.empty){console.warn(`No party payment found linked to ledger entry ${e}`);return}let l=r;l&&!l.includes("T")&&(l=new Date(l+"T00:00:00").toISOString());let o=s.docs.map(async e=>{let r={amount:t,date:l,updatedAt:new Date().toISOString()};void 0!==a&&(a&&a.trim()?r.note=a.trim():r.note=null),await (0,z.r7)((0,z.JU)(n,"partyPayments",e.id),r)});await Promise.all(o),console.log(`‚úÖ Updated party payment linked to ledger entry ${e}`)}catch(e){console.error("Error updating linked party payment:",e)}},handleDeleteConfirm=async()=>{if(er)try{let t=e.find(e=>e.id===er);t&&("credit"===t.type&&t.partyName&&await deleteLinkedPartyPayment(er),"debit"===t.type&&t.supplier&&await revertExpenseDistribution(er,t.supplier)),await s.ledgerService.remove(er),et(!1),ea(null)}catch(e){console.error("Failed to delete entry:",e),et(!1),ea(null)}},deleteLinkedPartyPayment=async e=>{try{let t=(0,M.z)();if(!t)throw Error("Firebase is not configured.");let r=(0,z.IO)((0,z.hJ)(t,"partyPayments"),(0,z.ar)("ledgerEntryId","==",e)),a=await (0,z.PL)(r);if(a.empty)return;let n=a.docs.map(async e=>{await (0,z.oe)((0,z.JU)(t,"partyPayments",e.id))});await Promise.all(n),console.log(`‚úÖ Deleted party payment linked to ledger entry ${e}`)}catch(e){console.error("Error deleting linked party payment:",e)}},updateLinkedPartyPaymentPartyName=async(e,t)=>{try{let r=(0,M.z)();if(!r)throw Error("Firebase is not configured.");let a=(0,z.IO)((0,z.hJ)(r,"partyPayments"),(0,z.ar)("ledgerEntryId","==",e)),n=await (0,z.PL)(a);if(n.empty){console.warn(`No party payment found linked to ledger entry ${e}`);return}let i=n.docs.map(async e=>{await (0,z.r7)((0,z.JU)(r,"partyPayments",e.id),{partyName:t,updatedAt:new Date().toISOString()})});await Promise.all(i),console.log(`‚úÖ Updated party name in payment linked to ledger entry ${e}`)}catch(e){console.error("Error updating party name in linked party payment:",e)}},revertExpenseDistribution=async(e,t)=>{try{let r=await k.XK.getAllOrders({supplier:t});for(let t of r){if(!t.id||!t.partialPayments)continue;let r=t.partialPayments.filter(t=>t.ledgerEntryId!==e);r.length<t.partialPayments.length&&(await k.XK.updateOrder(t.id,{partialPayments:r}),console.log(`‚úÖ Removed payments from order ${t.id} for ledger entry ${e}`))}console.log(`‚úÖ Reverted expense distribution for ledger entry ${e}`)}catch(e){console.error("Error reverting expense distribution:",e)}},revertIncomeDistribution=async(e,t)=>{try{let r=await k.XK.getAllOrders({partyName:t});for(let t of r){if(!t.id||!t.customerPayments)continue;let r=t.customerPayments.filter(t=>t.ledgerEntryId!==e);r.length<t.customerPayments.length&&(await k.XK.updateOrder(t.id,{customerPayments:r}),console.log(`‚úÖ Removed customer payments from order ${t.id} for ledger entry ${e}`))}console.log(`‚úÖ Reverted income distribution for ledger entry ${e}`)}catch(e){console.error("Error reverting income distribution:",e)}},renderEntry=e=>e.id?a.jsx("button",{onClick:t=>{(0,I.m)(t),handleEntryClick(e)},className:`w-full rounded-lg mb-1 p-2 active:bg-gray-50 transition-all duration-150 touch-manipulation native-press border ${"debit"===e.type&&e.supplier?"bg-red-50/40 border-red-200":"bg-white border-gray-100"}`,style:{WebkitTapHighlightColor:"transparent",position:"relative",overflow:"hidden"},children:(0,a.jsxs)("div",{className:"flex flex-col w-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between w-full mb-1",children:[a.jsx("span",{className:`font-bold ${"credit"===e.type?"text-green-700":"text-red-700"}`,style:{fontSize:"13px"},children:(0,f.formatIndianCurrency)(e.amount)}),a.jsx("span",{className:"text-gray-500 flex-shrink-0",style:{fontSize:"10px"},children:(0,l.ZP)(new Date(e.date),"dd MMM")})]}),e.note&&a.jsx("div",{className:"text-gray-600 text-left w-full mt-0.5",style:{fontSize:"11px",lineHeight:"1.3"},children:e.note}),"credit"===e.type&&e.partyName&&a.jsx("div",{className:"mt-1",children:(0,a.jsxs)("span",{className:"inline-block px-1.5 py-0.5 rounded bg-green-100 text-green-700 text-[10px] font-semibold",children:["Party: ",e.partyName]})}),"debit"===e.type&&e.supplier&&a.jsx("div",{className:"mt-1",children:(0,a.jsxs)("span",{className:"inline-block px-1.5 py-0.5 rounded bg-red-100 text-red-700 text-[10px] font-semibold",children:["Supplier: ",e.supplier]})})]})},e.id):null,renderActivity=e=>{let t=[];return"created"===e.activityType?(void 0!==e.amount&&null!==e.amount&&t.push({label:"Amount",old:null,new:e.amount,formatter:e=>(0,f.formatIndianCurrency)(e||0)}),e.date&&t.push({label:"Date",old:null,new:e.date,formatter:e=>e?(0,l.ZP)(new Date(e),"dd MMM yyyy"):"N/A"}),e.note&&t.push({label:"Note",old:null,new:e.note}),e.supplier&&t.push({label:"Supplier",old:null,new:e.supplier}),e.partyName&&t.push({label:"Party",old:null,new:e.partyName})):"deleted"===e.activityType?(void 0!==e.previousAmount&&null!==e.previousAmount&&t.push({label:"Amount",old:e.previousAmount,new:null,formatter:e=>(0,f.formatIndianCurrency)(e||0)}),e.previousDate&&t.push({label:"Date",old:e.previousDate,new:null,formatter:e=>e?(0,l.ZP)(new Date(e),"dd MMM yyyy"):"N/A"}),e.previousNote&&t.push({label:"Note",old:e.previousNote,new:null}),e.previousSupplier&&t.push({label:"Supplier",old:e.previousSupplier,new:null}),e.previousPartyName&&t.push({label:"Party",old:e.previousPartyName,new:null})):(e.previousAmount!==e.amount&&(void 0!==e.previousAmount||void 0!==e.amount)&&t.push({label:"Amount",old:e.previousAmount,new:e.amount,formatter:e=>(0,f.formatIndianCurrency)(e||0)}),e.previousDate!==e.date&&(e.previousDate||e.date)&&t.push({label:"Date",old:e.previousDate,new:e.date,formatter:e=>e?(0,l.ZP)(new Date(e),"dd MMM yyyy"):"N/A"}),e.previousNote!==e.note&&(void 0!==e.previousNote||void 0!==e.note)&&t.push({label:"Note",old:e.previousNote,new:e.note}),e.previousSupplier!==e.supplier&&(void 0!==e.previousSupplier||void 0!==e.supplier)&&t.push({label:"Supplier",old:e.previousSupplier,new:e.supplier}),e.previousPartyName!==e.partyName&&(void 0!==e.previousPartyName||void 0!==e.partyName)&&t.push({label:"Party",old:e.previousPartyName,new:e.partyName})),a.jsx("div",{className:`rounded-lg border-l-3 ${(()=>{switch(e.activityType){case"created":return"bg-green-50/50 border-l-3 border-green-500";case"updated":return"bg-blue-50/50 border-l-3 border-blue-500";case"deleted":return"bg-red-50/50 border-l-3 border-red-500";default:return"bg-gray-50/50 border-l-3 border-gray-400"}})()} transition-all duration-150 hover:shadow-sm`,style:{borderLeftWidth:"3px"},children:(0,a.jsxs)("div",{className:"p-2.5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[a.jsx("div",{className:"flex-shrink-0",children:(()=>{switch(e.activityType){case"created":return a.jsx(o.Z,{size:14,className:"text-green-600"});case"updated":return a.jsx(d.Z,{size:14,className:"text-blue-600"});case"deleted":return a.jsx(c.Z,{size:14,className:"text-red-600"});default:return null}})()}),a.jsx("span",{className:"font-semibold text-gray-900 text-xs",children:(()=>{switch(e.activityType){case"created":return"Created";case"updated":return"Updated";case"deleted":return"Deleted";default:return"Activity"}})()}),e.type&&a.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-semibold flex-shrink-0 ${"credit"===e.type?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:"credit"===e.type?"Income":"Expense"})]}),a.jsx("span",{className:"text-gray-500 text-[10px] flex-shrink-0 ml-2",children:(e=>{let t=new Date(e),r=new Date,a=r.getTime()-t.getTime(),n=Math.floor(a/6e4),i=Math.floor(a/36e5),s=Math.floor(a/864e5);return n<1?"Just now":n<60?`${n}m ago`:i<24?`${i}h ago`:s<7?`${s}d ago`:(0,l.ZP)(t,"dd MMM, hh:mm a")})(e.timestamp)})]}),t.length>0&&a.jsx("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1 mt-1.5",children:t.map((t,r)=>(0,a.jsxs)("div",{className:"flex items-center gap-1 text-[10px]",children:[(0,a.jsxs)("span",{className:"text-gray-500 font-medium",children:[t.label,":"]}),"created"===e.activityType?a.jsx("span",{className:"text-gray-800 font-semibold",children:t.formatter?t.formatter(t.new):String(t.new)}):"deleted"===e.activityType?a.jsx("span",{className:"text-gray-600 line-through",children:t.formatter?t.formatter(t.old):String(t.old)}):(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[void 0!==t.old&&null!==t.old&&""!==t.old&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("span",{className:"text-red-600 line-through",children:t.formatter?t.formatter(t.old):String(t.old)}),a.jsx("span",{className:"text-gray-400",children:"‚Üí"})]}),void 0!==t.new&&null!==t.new&&""!==t.new?a.jsx("span",{className:"text-green-600 font-semibold",children:t.formatter?t.formatter(t.new):String(t.new)}):void 0!==t.old&&a.jsx("span",{className:"text-gray-400 italic",children:"removed"})]})]},r))})]})},e.id)};return B?a.jsx(LedgerEntryWizard,{entry:Y||null,type:X,onClose:()=>{K(!1),Q(null)},onSave:handleSaveEntry,onDelete:e=>{ea(e),et(!0)},onDeleteConfirm:async t=>{try{let r=e.find(e=>e.id===t);r&&("credit"===r.type&&r.partyName&&await revertIncomeDistribution(t,r.partyName),"debit"===r.type&&r.supplier&&await revertExpenseDistribution(t,r.supplier)),await s.ledgerService.remove(t),K(!1),Q(null)}catch(e){throw console.error("Failed to delete entry:",e),e}}}):(0,a.jsxs)("div",{className:"bg-gray-50",style:{height:"100dvh",minHeight:"100dvh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,a.jsxs)("div",{className:"bg-primary-600 text-white p-2 pt-safe sticky top-0 z-40",style:{flexShrink:0},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0",children:[a.jsx(m.Z,{size:18}),a.jsx("h1",{className:"text-lg font-bold truncate",children:"Ledger"})]}),"activity"===S&&a.jsx("button",{onClick:e=>{(0,I.m)(e),W(!E)},className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-lg active:bg-white/30 transition-colors touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:a.jsx(u.Z,{size:16})})]}),"entries"===S&&(0,a.jsxs)("div",{className:"bg-white rounded-lg p-2 text-gray-800 flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",style:{fontSize:"12px"},children:"Balance"}),(0,a.jsxs)("span",{className:`font-bold ${ef>=0?"text-green-700":"text-red-600"}`,style:{fontSize:"12px"},children:[(0,f.formatIndianCurrency)(Math.abs(ef))," ",ef>=0?"":"(Dr)"]})]}),(0,a.jsxs)("div",{className:"flex gap-1 mt-2 overflow-x-auto pb-1 no-scrollbar",children:[(0,a.jsxs)("button",{onClick:e=>{(0,I.m)(e),$("entries")},className:`flex-1 py-2 px-3 whitespace-nowrap rounded-lg font-medium transition-all duration-200 touch-manipulation flex items-center justify-center gap-1.5 ${"entries"===S?"bg-white text-primary-600 shadow-sm":"bg-white/20 text-white/80 active:bg-white/30"}`,style:{fontSize:"13px",WebkitTapHighlightColor:"transparent"},children:[a.jsx(p.Z,{size:14}),"Entries"]}),(0,a.jsxs)("button",{onClick:e=>{(0,I.m)(e),$("timeline")},className:`flex-1 py-2 px-3 whitespace-nowrap rounded-lg font-medium transition-all duration-200 touch-manipulation flex items-center justify-center gap-1.5 ${"timeline"===S?"bg-white text-primary-600 shadow-sm":"bg-white/20 text-white/80 active:bg-white/30"}`,style:{fontSize:"13px",WebkitTapHighlightColor:"transparent"},children:[a.jsx(g.Z,{size:14}),"Timeline"]}),(0,a.jsxs)("button",{onClick:e=>{(0,I.m)(e),$("activity")},className:`flex-1 py-2 px-3 whitespace-nowrap rounded-lg font-medium transition-all duration-200 touch-manipulation flex items-center justify-center gap-1.5 ${"activity"===S?"bg-white text-primary-600 shadow-sm":"bg-white/20 text-white/80 active:bg-white/30"}`,style:{fontSize:"13px",WebkitTapHighlightColor:"transparent"},children:[a.jsx(x.Z,{size:14}),"Log"]}),(0,a.jsxs)("button",{onClick:e=>{(0,I.m)(e),$("investment")},className:`flex-1 py-2 px-3 whitespace-nowrap rounded-lg font-medium transition-all duration-200 touch-manipulation flex items-center justify-center gap-1.5 ${"investment"===S?"bg-white text-primary-600 shadow-sm":"bg-white/20 text-white/80 active:bg-white/30"}`,style:{fontSize:"13px",WebkitTapHighlightColor:"transparent"},children:[a.jsx(m.Z,{size:14}),"Inv."]})]}),E&&"activity"===S&&(0,a.jsxs)("div",{className:"mt-2 bg-white/95 backdrop-blur-xl rounded-lg p-2 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-gray-800 font-medium",style:{fontSize:"12px"},children:"Date Range"}),a.jsx("button",{onClick:e=>{(0,I.m)(e),F(""),R("")},className:"text-primary-600 text-xs font-medium active:opacity-70 touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:"Clear"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:q,onChange:e=>F(e.target.value),className:"w-full px-2 py-1.5 bg-gray-50 border border-gray-200 rounded-lg text-xs text-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:U,onChange:e=>R(e.target.value),className:"w-full px-2 py-1.5 bg-gray-50 border border-gray-200 rounded-lg text-xs text-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:[a.jsx("button",{type:"button",onClick:()=>handleModeChange("add"),className:`px-2 py-1 rounded-lg text-xs font-medium ${"add"===ey?"bg-amber-600 text-white":"bg-gray-100 text-gray-800"} active:opacity-80`,children:"Add Investment"}),a.jsx("button",{type:"button",onClick:()=>handleModeChange("reduce"),className:`px-2 py-1 rounded-lg text-xs font-medium ${"reduce"===ey?"bg-amber-600 text-white":"bg-gray-100 text-gray-800"} active:opacity-80`,children:"Reduce Amount"}),a.jsx("button",{type:"button",onClick:()=>handleModeChange("set"),className:`px-2 py-1 rounded-lg text-xs font-medium ${"set"===ey?"bg-amber-600 text-white":"bg-gray-100 text-gray-800"} active:opacity-80`,children:"Set Exact Value"})]})]})]}),a.jsx("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",paddingBottom:"entries"===S?"9.25rem":"5rem"},children:"entries"===S?N?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx(A.Z,{size:100})}):(0,a.jsxs)("div",{className:"flex-1 grid grid-cols-2 gap-1.5 p-1.5",style:{minHeight:0},children:[(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg p-1.5 border border-green-200 flex flex-col",style:{minHeight:0},children:[a.jsx("div",{className:"flex items-center justify-between mb-1.5 flex-shrink-0",children:(0,a.jsxs)("h2",{className:"font-semibold text-green-800 flex items-center gap-1",style:{fontSize:"12px"},children:[a.jsx(o.Z,{size:14}),"Income"]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-1.5 mb-1.5 border border-green-300 flex-shrink-0",children:[a.jsx("div",{className:"text-gray-600",style:{fontSize:"11px"},children:"Total"}),a.jsx("div",{className:"font-bold text-green-700",style:{fontSize:"12px"},children:(0,f.formatIndianCurrency)(ew)})]}),a.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",style:{minHeight:0,WebkitOverflowScrolling:"touch"},children:0===eb.length?a.jsx("div",{className:"text-center text-gray-400 py-4",style:{fontSize:"11px"},children:"No entries"}):eb.map(renderEntry)})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-1.5 border border-red-200 flex flex-col",style:{minHeight:0},children:[a.jsx("div",{className:"flex items-center justify-between mb-1.5 flex-shrink-0",children:(0,a.jsxs)("h2",{className:"font-semibold text-red-800 flex items-center gap-1",style:{fontSize:"12px"},children:[a.jsx(y.Z,{size:14}),"Expenses"]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-1.5 mb-1.5 border border-red-300 flex-shrink-0",children:[a.jsx("div",{className:"text-gray-600",style:{fontSize:"11px"},children:"Total"}),a.jsx("div",{className:"font-bold text-red-700",style:{fontSize:"12px"},children:(0,f.formatIndianCurrency)(eN)})]}),a.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",style:{minHeight:0,WebkitOverflowScrolling:"touch"},children:0===ev.length?a.jsx("div",{className:"text-center text-gray-400 py-4",style:{fontSize:"11px"},children:"No entries"}):ev.map(renderEntry)})]})]}):"timeline"===S?a.jsx("div",{className:"flex-1 overflow-y-auto",style:{WebkitOverflowScrolling:"touch"},children:N?a.jsx("div",{className:"flex-1 flex items-center justify-center py-12",children:a.jsx(A.Z,{size:100})}):a.jsx(LedgerTimelineView,{entries:e,investment:en,investmentHistory:es,invoices:r,orders:v})}):"investment"===S?(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 space-y-4",style:{WebkitOverflowScrolling:"touch"},children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 rounded-2xl p-4 text-white shadow-lg relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:a.jsx(m.Z,{size:100})}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-2 bg-white/20 rounded-xl backdrop-blur-sm",children:a.jsx(m.Z,{size:20,className:"text-white"})}),a.jsx("h3",{className:"text-lg font-bold text-white",children:"Current Investment"})]}),a.jsx("button",{onClick:e=>{(0,I.m)(e),openInvestmentDrawer()},className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors backdrop-blur-sm",children:a.jsx(d.Z,{size:18,className:"text-white"})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-amber-100 mb-1",children:"Total Capital Invested"}),a.jsx("p",{className:"text-3xl font-bold",children:en?(0,f.formatIndianCurrency)(en.amount):(0,f.formatIndianCurrency)(0)})]}),en&&(0,a.jsxs)("div",{className:"space-y-2 text-sm text-amber-50",children:[(0,a.jsxs)("div",{className:"flex justify-between border-b border-white/10 pb-2",children:[a.jsx("span",{children:"Date"}),a.jsx("span",{className:"font-medium",children:(0,l.ZP)(new Date(en.date),"dd MMM yyyy")})]}),en.note&&(0,a.jsxs)("div",{className:"flex justify-between border-b border-white/10 pb-2",children:[a.jsx("span",{children:"Note"}),a.jsx("span",{className:"font-medium",children:en.note})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-1",children:[a.jsx("span",{children:"Last Updated"}),a.jsx("span",{className:"font-medium",children:en.updatedAt?(0,l.ZP)(new Date(en.updatedAt),"dd MMM yyyy HH:mm"):(0,l.ZP)(new Date(en.createdAt||en.date),"dd MMM yyyy HH:mm")})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-base font-bold text-gray-800 mb-3 flex items-center gap-2",children:[a.jsx(x.Z,{size:18,className:"text-gray-500"}),"History"]}),a.jsx("div",{className:"space-y-3",children:0===es.length?a.jsx("div",{className:"text-center text-gray-400 py-8 bg-gray-50 rounded-xl border border-gray-100",children:"No history available"}):es.map(e=>(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-gray-100 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`p-1.5 rounded-lg ${"created"===e.activityType?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600"}`,children:"created"===e.activityType?a.jsx(h.Z,{size:14}):a.jsx(d.Z,{size:14})}),(0,a.jsxs)("span",{className:"font-medium text-gray-900 text-sm capitalize",children:["Investment ",e.activityType]})]}),a.jsx("span",{className:"text-xs text-gray-500",children:(0,l.ZP)(new Date(e.timestamp),"dd MMM HH:mm")})]}),(0,a.jsxs)("div",{className:"pl-9 space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Amount"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[void 0!==e.previousAmount&&e.previousAmount!==e.amount&&a.jsx("span",{className:"text-gray-400 line-through text-xs",children:(0,f.formatIndianCurrency)(e.previousAmount)}),a.jsx("span",{className:"font-bold text-gray-900",children:(0,f.formatIndianCurrency)(e.amount)})]})]}),void 0!==e.previousDate&&e.previousDate!==e.date&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-500",children:"Date Changed"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-gray-400 line-through",children:(0,l.ZP)(new Date(e.previousDate),"dd MMM yyyy")}),a.jsx("span",{children:"‚Üí"}),a.jsx("span",{className:"text-gray-700",children:(0,l.ZP)(new Date(e.date),"dd MMM yyyy")})]})]})]})]},e.id))})]})]}):a.jsx("div",{className:"flex-1 overflow-y-auto p-1.5",style:{WebkitOverflowScrolling:"touch"},children:P?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(A.Z,{size:80})}):0===C.length?(0,a.jsxs)("div",{className:"text-center text-gray-400 py-12",style:{fontSize:"13px"},children:["No activity logs found",(q||U)&&a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Try adjusting the date range"})]}):a.jsx("div",{className:"space-y-1.5",children:C.map(e=>renderActivity(e))})})}),"entries"===S&&a.jsx("div",{className:"fixed left-0 right-0 z-30 flex items-end justify-center",style:{bottom:"5.25rem",paddingLeft:"max(0.75rem, env(safe-area-inset-left, 0px))",paddingRight:"max(0.75rem, env(safe-area-inset-right, 0px))",pointerEvents:"none"},children:a.jsx("div",{className:"bg-white/95 backdrop-blur-xl border border-gray-200/60 rounded-2xl w-full",style:{padding:"0.75rem",boxShadow:"0 2px 16px rgba(0, 0, 0, 0.06), 0 1px 4px rgba(0, 0, 0, 0.03)",pointerEvents:"auto"},children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:e=>{(0,I.m)(e),handleAddEntry("credit")},className:"flex-1 bg-green-600 text-white rounded-xl active:bg-green-700 transition-colors flex items-center justify-center gap-2 py-3 touch-manipulation font-medium native-press",style:{WebkitTapHighlightColor:"transparent",fontSize:"14px",position:"relative",overflow:"hidden"},title:"Add Income","aria-label":"Add Income",children:[a.jsx(h.Z,{size:18}),a.jsx("span",{children:"Add Income"})]}),(0,a.jsxs)("button",{onClick:e=>{(0,I.m)(e),handleAddEntry("debit")},className:"flex-1 bg-red-600 text-white rounded-xl active:bg-red-700 transition-colors flex items-center justify-center gap-2 py-3 touch-manipulation font-medium native-press",style:{WebkitTapHighlightColor:"transparent",fontSize:"14px",position:"relative",overflow:"hidden"},title:"Add Expense","aria-label":"Add Expense",children:[a.jsx(h.Z,{size:18}),a.jsx("span",{children:"Add Expense"})]})]})})}),a.jsx(BottomSheet,{isOpen:ee,onClose:()=>{et(!1),ea(null)},onConfirm:handleDeleteConfirm,title:"Delete Entry?",message:"This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmColor:"red"}),a.jsx(BottomSheet,{isOpen:eo,onClose:()=>ed(!1),title:"Update Investment",confirmText:"Save",cancelText:"Cancel",onConfirm:handleSaveInvestment,confirmColor:"amber",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Investment Amount"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"‚Çπ"}),a.jsx("input",{type:"number",value:ec,onChange:e=>em(e.target.value),className:"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",placeholder:"0"})]}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:[a.jsx("button",{type:"button",onClick:()=>handleModeChange("add"),className:`px-2 py-1 rounded-lg text-xs font-medium ${"add"===ey?"bg-amber-600 text-white":"bg-gray-100 text-gray-800"} active:opacity-80`,children:"Add Investment"}),a.jsx("button",{type:"button",onClick:()=>handleModeChange("reduce"),className:`px-2 py-1 rounded-lg text-xs font-medium ${"reduce"===ey?"bg-amber-600 text-white":"bg-gray-100 text-gray-800"} active:opacity-80`,children:"Reduce Amount"}),a.jsx("button",{type:"button",onClick:()=>handleModeChange("set"),className:`px-2 py-1 rounded-lg text-xs font-medium ${"set"===ey?"bg-amber-600 text-white":"bg-gray-100 text-gray-800"} active:opacity-80`,children:"Set Exact Value"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),a.jsx("textarea",{value:eg,onChange:e=>ex(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none resize-none",rows:3,placeholder:"Add a note about this investment..."})]})]})}),a.jsx(b.Z,{})]})}},60991:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>s,__esModule:()=>i,default:()=>o});var a=r(95153);let n=(0,a.createProxy)(String.raw`C:\Users\ashis\Desktop\royalsuppliers\royalsuppliers\app\ledger\page.tsx`),{__esModule:i,$$typeof:s}=n,l=n.default,o=l}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[252,166,392,813,282,943,123,233,766,599,512,365],()=>__webpack_exec__(95480));module.exports=r})();