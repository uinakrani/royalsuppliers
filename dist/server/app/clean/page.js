(()=>{var e={};e.id=968,e.ids=[968],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},72032:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>p,tree:()=>o});var r=s(67096),a=s(16132),l=s(37284),i=s.n(l),n=s(32564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(t,c);let o=["",{children:["clean",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,80231)),"C:\\Users\\ashis\\Desktop\\royalsuppliers\\royalsuppliers\\app\\clean\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,29184)),"C:\\Users\\ashis\\Desktop\\royalsuppliers\\royalsuppliers\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\ashis\\Desktop\\royalsuppliers\\royalsuppliers\\app\\clean\\page.tsx"],x="/clean/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/clean/page",pathname:"/clean",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},30142:(e,t,s)=>{Promise.resolve().then(s.bind(s,94253))},94253:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>CleanPage});var r=s(30784),a=s(60755),l=s(29904);let clearFinancials=async(e={clearOrders:!1,clearInvestment:!0,clearLedger:!0,clearActivityLogs:!0,clearPartyPayments:!0,clearOrderPayments:!0})=>{let t=(0,a.z)();if(!t){console.error("Firebase not initialized");return}let s=(0,l.qs)(t),r=0,commitBatch=async()=>{r>0&&(await s.commit(),console.log(`Committed batch of ${r} operations`),r=0)};if(e.clearLedger){console.log("Clearing ledger entries...");let e=await (0,l.PL)((0,l.hJ)(t,"ledgerEntries"));e.forEach(e=>{s.delete(e.ref),r++})}if(e.clearPartyPayments){console.log("Clearing party payments...");let e=await (0,l.PL)((0,l.hJ)(t,"partyPayments"));e.forEach(e=>{s.delete(e.ref),r++})}if(e.clearActivityLogs){console.log("Clearing ledger activities...");let e=await (0,l.PL)((0,l.hJ)(t,"ledgerActivities"));e.forEach(e=>{s.delete(e.ref),r++}),console.log("Clearing investment activities...");let a=await (0,l.PL)((0,l.hJ)(t,"investmentActivity"));a.forEach(e=>{s.delete(e.ref),r++})}if(e.clearInvestment){console.log("Clearing investment...");let e=await (0,l.PL)((0,l.hJ)(t,"investment"));e.forEach(e=>{s.delete(e.ref),r++})}if(r>=450&&await commitBatch(),e.clearOrders){console.log("Deleting all orders...");let e=await (0,l.PL)((0,l.hJ)(t,"orders"));e.forEach(e=>{s.delete(e.ref),r++})}else if(e.clearOrderPayments){console.log("Clearing order payments...");let e=await (0,l.PL)((0,l.hJ)(t,"orders"));for(let a of e.docs){let e=(0,l.JU)(t,"orders",a.id),i=a.data();(i.partialPayments&&i.partialPayments.length>0||i.customerPayments&&i.customerPayments.length>0||i.adjustmentAmount)&&(s.update(e,{partialPayments:[],customerPayments:[],adjustmentAmount:0}),r++),r>=450&&await commitBatch()}}await commitBatch(),console.log("Selected financial data cleared successfully.")};var i=s(9885),n=s(64782),c=s(2861),o=s(94409),d=s(59816),x=s(48168),m=s(26303);function CleanPage(){let[e,t]=(0,i.useState)("Idle"),[s,a]=(0,i.useState)({clearOrders:!1,clearInvestment:!1,clearLedger:!1,clearActivityLogs:!1,clearPartyPayments:!1,clearOrderPayments:!1}),toggleOption=e=>{a(t=>({...t,[e]:!t[e]}))},handleClean=async()=>{if(!Object.values(s).some(e=>e)){n.h.error("No Selection","Please select at least one data type to clear.");return}let e=await n.h.confirm({title:"Clear Selected Data?",message:"This action is irreversible. Are you sure you want to proceed with deleting the selected data?",icon:"warning",confirmText:"Yes, Delete Selected",cancelText:"Cancel"});if(e){t("Cleaning...");try{await clearFinancials(s),t("Done! Cleanup complete."),n.h.success("Success","Selected data has been cleared."),a({clearOrders:!1,clearInvestment:!1,clearLedger:!1,clearActivityLogs:!1,clearPartyPayments:!1,clearOrderPayments:!1})}catch(e){console.error(e),t("Error: "+e),n.h.error("Error","Failed to clear data.")}}};return(0,r.jsxs)("div",{className:"bg-gray-50 min-h-screen flex flex-col",children:[(0,r.jsxs)("div",{className:"p-4 pb-24",children:[r.jsx("h1",{className:"text-2xl font-bold mb-4 text-gray-900",children:"Data Management"}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-100 bg-red-50",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-700 mb-1",children:[r.jsx(o.Z,{size:20}),r.jsx("h2",{className:"text-lg font-semibold",children:"Danger Zone"})]}),r.jsx("p",{className:"text-xs text-red-600",children:"Select the data you want to permanently delete from the database."})]}),(0,r.jsxs)("div",{className:"divide-y divide-gray-100",children:[(0,r.jsxs)("label",{className:"flex items-center p-4 hover:bg-gray-50 cursor-pointer",children:[r.jsx("div",{className:"flex-shrink-0 mr-3 text-primary-600",children:s.clearOrders?r.jsx(d.Z,{size:24}):r.jsx(x.Z,{size:24})}),r.jsx("input",{type:"checkbox",className:"hidden",checked:!!s.clearOrders,onChange:()=>toggleOption("clearOrders")}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Orders"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Delete all order records permanently"})]})]}),(0,r.jsxs)("label",{className:"flex items-center p-4 hover:bg-gray-50 cursor-pointer",children:[r.jsx("div",{className:"flex-shrink-0 mr-3 text-primary-600",children:s.clearOrderPayments?r.jsx(d.Z,{size:24}):r.jsx(x.Z,{size:24})}),r.jsx("input",{type:"checkbox",className:"hidden",checked:!!s.clearOrderPayments,onChange:()=>toggleOption("clearOrderPayments")}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Order Payments"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Clear partial & customer payments inside orders (keeps orders)"})]})]}),(0,r.jsxs)("label",{className:"flex items-center p-4 hover:bg-gray-50 cursor-pointer",children:[r.jsx("div",{className:"flex-shrink-0 mr-3 text-primary-600",children:s.clearLedger?r.jsx(d.Z,{size:24}):r.jsx(x.Z,{size:24})}),r.jsx("input",{type:"checkbox",className:"hidden",checked:!!s.clearLedger,onChange:()=>toggleOption("clearLedger")}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Ledger & Timeline"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Delete all ledger entries (Income/Expense)"})]})]}),(0,r.jsxs)("label",{className:"flex items-center p-4 hover:bg-gray-50 cursor-pointer",children:[r.jsx("div",{className:"flex-shrink-0 mr-3 text-primary-600",children:s.clearPartyPayments?r.jsx(d.Z,{size:24}):r.jsx(x.Z,{size:24})}),r.jsx("input",{type:"checkbox",className:"hidden",checked:!!s.clearPartyPayments,onChange:()=>toggleOption("clearPartyPayments")}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Party Payments"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Delete standalone party payment records"})]})]}),(0,r.jsxs)("label",{className:"flex items-center p-4 hover:bg-gray-50 cursor-pointer",children:[r.jsx("div",{className:"flex-shrink-0 mr-3 text-primary-600",children:s.clearInvestment?r.jsx(d.Z,{size:24}):r.jsx(x.Z,{size:24})}),r.jsx("input",{type:"checkbox",className:"hidden",checked:!!s.clearInvestment,onChange:()=>toggleOption("clearInvestment")}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Investment"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Reset investment capital data"})]})]}),(0,r.jsxs)("label",{className:"flex items-center p-4 hover:bg-gray-50 cursor-pointer",children:[r.jsx("div",{className:"flex-shrink-0 mr-3 text-primary-600",children:s.clearActivityLogs?r.jsx(d.Z,{size:24}):r.jsx(x.Z,{size:24})}),r.jsx("input",{type:"checkbox",className:"hidden",checked:!!s.clearActivityLogs,onChange:()=>toggleOption("clearActivityLogs")}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Activity Logs"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Clear history of changes (Ledger/Investment logs)"})]})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-gray-50 border-t border-gray-100",children:[(0,r.jsxs)("button",{onClick:handleClean,className:"w-full bg-red-600 text-white px-4 py-3 rounded-lg hover:bg-red-700 font-medium active:bg-red-800 transition-colors flex items-center justify-center gap-2 shadow-sm",children:[r.jsx(m.Z,{size:18}),"Delete Selected Data"]}),(0,r.jsxs)("p",{className:"mt-3 text-xs text-center text-gray-500 font-mono",children:["Status: ",e]})]})]})]}),r.jsx(c.Z,{})]})}},64782:(e,t,s)=>{"use strict";s.d(t,{h:()=>r.nativePopup});var r=s(3149)},80231:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>c});var r=s(95153);let a=(0,r.createProxy)(String.raw`C:\Users\ashis\Desktop\royalsuppliers\royalsuppliers\app\clean\page.tsx`),{__esModule:l,$$typeof:i}=a,n=a.default,c=n}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[252,166,392,159,943,123],()=>__webpack_exec__(72032));module.exports=s})();